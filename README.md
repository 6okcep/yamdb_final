# Проект api_yamdb
## Описание
Проект YaMDb собирает отзывы (Review) пользователей на произведения (Titles). Произведения делятся на категории:
«Книги», «Фильмы», «Музыка». Список категорий (Category) может быть расширен администратором (например,
можно добавить категорию «изобразительное искусство» или «Ювелирка»).
Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения 
«Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» 
группы «Насекомые» и вторая сюита Баха.
Произведению может быть присвоен жанр (Genre) из списка предустановленных (например, «Сказка», 
«Рок» или «Артхаус»). Новые жанры может создавать только администратор.
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы (Review)
и ставят произведению оценку в диапазоне от одного до десяти (целое число); 
из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). 
На одно произведение пользователь может оставить только один отзыв.

Проект настроен на автоматическое развертывание на вашем удаленном сервере в Docker через создание образа приложения в вашем Docker Hub. После развертывания ваш Тегерам-бот будет присылать вам уведомление.
## Технологии
Python 3.7, Django 2.2, DRF, JWT
## Запуск проекта в Docker на удаленном сервере через Github Actions
На сервере должен быть установлен docker и docker-compose. Если на сервере есть работающий nginxб остановите его.
- Клонировать репозиторий
- Заполнить Secretes для проекта на Github:
  - DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
  - DB_NAME=postgres # имя базы данных
  - POSTGRES_USER=postgres # логин для подключения к базе данных
  - POSTGRES_PASSWORD=postgres # пароль для подключения к БД (установите свой)
  - DB_HOST=db # название сервиса (контейнера)
  - DB_PORT=5432 # порт для подключения к БД
  - DOCKER_USERNAME # ваш DockerHub
  - DOCKER_DOCKER_PASSWORD # ваш пароль DockerHub
  - HOST # IP-адрес вашего сервера
  - USER # имя пользователя для подключения к серверу
  - SSH_KEY # приватный ключ с компьютера, имеющего доступ к боевому серверу
  - PASSPHRASE # указать, если при создании ssh-ключа вы использовали фразу-пароль
  - TELEGRAM_TO # ID вашего телеграм-аккаунта
  - TELEGRAM_TOKEN # токен вашего бота
- В файле docker-compose указать ваш Docker Hub, где будет расположен image приложения web
- Скопируйте файлы docker-compose.yaml и nginx/default.conf на сервер в home/<ваш_username>/docker-compose.yaml и home/<ваш_username>/nginx/default.conf соответственно.
- Сделайте push проекта
- На сервере нужно через консоль зайти в контейнер приложения, выполнить миграции и создать суперпользователя
```
$ docker exec -it <CONTAINER ID> bash
$ ./manage.py migrate
$ ./manage.py createsuperuser
```
- Для отображения статики выполнить команду:
```
$ ./manage.py collectstatic --no-input
```
- Если есть необходимость, заполнить базу тестовыми данными командой:
```
$ ./manage.py loaddata dump.json 
```
- Запускаем проект по адресу вашего сервера со страницы /admin

## Примеры работы с API для всех пользователей
- GET /api/v1/titles/
```
[
  {
    "count": 0,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "id": 0,
        "name": "string",
        "year": 0,
        "rating": 0,
        "description": "string",
        "genre": [
          {
            "name": "string",
            "slug": "string"
          }
        ],
        "category": {
          "name": "string",
          "slug": "string"
        }
      }
    ]
  }
]
```
- GET /api/v1/categories/
```
[
  {
    "count": 0,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "name": "string",
        "slug": "string"
      }
    ]
  }
]
```
Подробная документация доступна по адресу /redoc/


## Команда авторов
- Vasily Popov
- Dmitry Bokser
- Dmitry Guryaev


![workflow after push](https://github.com/6okcep/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg?event=push)